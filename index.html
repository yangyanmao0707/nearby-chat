<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ğŸ“± è·¯äººå³æ™‚é€š</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI";
  background: #f3f4f6;
  margin: 0;
  padding: 10px;
}
h2 {
  text-align: center;
}
#chat {
  background: white;
  height: 65vh;
  overflow-y: auto;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #ddd;
}
.msg {
  margin-bottom: 8px;
}
.name {
  font-weight: bold;
  color: #4f46e5;
}
input, button {
  width: 100%;
  padding: 10px;
  font-size: 16px;
  margin-top: 5px;
  border-radius: 8px;
  border: 1px solid #ccc;
}
button {
  background: #4f46e5;
  color: white;
  border: none;
}
</style>
</head>

<body>

<h2>ğŸ“± è·¯äººå³æ™‚é€š</h2>

<input id="name" placeholder="ä½ çš„æš±ç¨±ï¼ˆå¯ä¸å¡«ï¼‰">

<div id="chat"></div>

<input id="text" placeholder="è¼¸å…¥è¨Šæ¯">
<button onclick="send()">é€å‡º</button>

<script>
// âœ…ã€ä¸€å®šè¦æ›æˆä½ è‡ªå·±çš„ Firebase è¨­å®šã€‘
const firebaseConfig = {
  apiKey: "ä½ çš„_apiKey",
  authDomain: "ä½ çš„_authDomain",
  projectId: "ä½ çš„_projectId",
};

// åˆå§‹åŒ– Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const chat = document.getElementById("chat");

// âœ… å³æ™‚ç›£è½æ‰€æœ‰è¨Šæ¯
db.collection("messages")
  .orderBy("time")
  .onSnapshot(snapshot => {
    chat.innerHTML = "";
    snapshot.forEach(doc => {
      const d = doc.data();
      if (!d.text) return;
      chat.innerHTML += `
        <div class="msg">
          <span class="name">${d.name || "è·¯äºº"}ï¼š</span>
          ${d.text}
        </div>`;
    });
    chat.scrollTop = chat.scrollHeight;
  });

// âœ… å‚³é€è¨Šæ¯
function send() {
  const name = document.getElementById("name").value.trim() || "è·¯äºº";
  const text = document.getElementById("text").value.trim();
  if (!text) return;

  db.collection("messages").add({
    name: name,
    text: text,
    time: firebase.firestore.FieldValue.serverTimestamp()
  });

  document.getElementById("text").value = "";
}
</script>

</body>
</html>